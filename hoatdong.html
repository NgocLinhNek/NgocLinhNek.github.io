<!DOCTYPE html>
<html>
<head>
<title>Hoạt động & Lịch</title>
<link rel="stylesheet" href="style.css">

<style>
.calendar{background:white;padding:20px;border-radius:8px;max-width:800px;}
.month{display:flex;justify-content:space-between;align-items:center;}
.days,.dates{display:grid;grid-template-columns:repeat(7,1fr);text-align:center;}
.days div{font-weight:bold;padding:10px 0;}
.dates div{border:1px solid #ddd;padding:10px;min-height:90px;cursor:pointer;}
.today{background:#3498db;color:white;}

.event{color:white;font-size:11px;padding:3px 6px;border-radius:5px;margin-top:3px;cursor:pointer;}
.meeting{background:#2980b9;}
.exam{background:#e74c3c;}
.activity{background:#8e44ad;}
.other{background:#7f8c8d;}
.legend span{padding:5px 10px;color:white;border-radius:5px;margin-right:10px;}
</style>
</head>

<body>
<header><h2>Hoạt động & Lịch</h2></header>

<div class="container">
<div class="sidebar">
<a href="index.html">Trang chủ</a>
<a href="tuyenTV.html">Tuyển TV</a>
<a href="hoatdong.html">Hoạt động</a>
<a href="baiviet.html">Bài viết</a>
<a href="lienhe.html">Liên hệ</a>
</div>

<div class="main">
<div class="calendar">
<div class="month">
<button onclick="prevMonth()">◀</button>
<h3 id="monthYear"></h3>
<button onclick="nextMonth()">▶</button>
</div>

<div class="legend">
<span class="meeting">Họp</span>
<span class="exam">Thi</span>
<span class="activity">Ngoại khóa</span>
<span class="other">Khác</span>
</div>

<br>

<div class="days">
<div>CN</div><div>T2</div><div>T3</div><div>T4</div>
<div>T5</div><div>T6</div><div>T7</div>
</div>

<div class="dates" id="dates"></div>

</div>
</div>
</div>

<script>
let currentDate = new Date();
let events = JSON.parse(localStorage.getItem("events")) || {};

function renderCalendar(){
    const y = currentDate.getFullYear(), m = currentDate.getMonth();
    const firstDay = new Date(y,m,1).getDay();
    const lastDate = new Date(y,m+1,0).getDate();
    const today = new Date();
    document.getElementById("monthYear").innerText = Tháng ${m+1} - ${y};
    const dates = document.getElementById("dates");
    dates.innerHTML = "";

    for(let i=0;i<firstDay;i++) dates.innerHTML += "<div></div>";

    for(let d=1; d<=lastDate; d++){
        const key = ${y}-${m}-${d};
        let box = document.createElement("div");
        if(d===today.getDate() && m===today.getMonth() && y===today.getFullYear()) box.classList.add("today");
        box.innerHTML = <strong>${d}</strong>;
if(events[key]){
            events[key].forEach((ev,idx)=>{
                let e = document.createElement("div");
                e.className = event ${ev.type};
                e.innerText = ev.title;
                e.onclick = (x)=>{ x.stopPropagation(); editEvent(key,idx); };
                box.appendChild(e);
            });
        }
        box.onclick = ()=>addEvent(key);
        dates.appendChild(box);
    }
}

function addEvent(key){
    let title = prompt("Tên sự kiện:");
    if(!title) return;
    let type = prompt("Loại: hop / thi / ngoai / khac").toLowerCase();
    let map = {hop:"meeting", thi:"exam", ngoai:"activity", khac:"other"};
    if(!map[type]) type="other"; else type = map[type];

    if(!events[key]) events[key]=[];
    events[key].push({title, type});
    save();
}

function editEvent(key,index){
    let ev = events[key][index];
    let newTitle = prompt("Sửa tên (hoặc gõ xoa):", ev.title);
    if(newTitle==="xoa"){
        events[key].splice(index,1);
        if(events[key].length===0) delete events[key];
    }
    else if(newTitle){
        ev.title=newTitle;
    }
    save();
}

function save(){
    localStorage.setItem("events",JSON.stringify(events));
    renderCalendar();
}
function prevMonth(){ currentDate.setMonth(currentDate.getMonth()-1); renderCalendar(); }
function nextMonth(){ currentDate.setMonth(currentDate.getMonth()+1); renderCalendar(); }

renderCalendar();
</script>

</body>
</html>